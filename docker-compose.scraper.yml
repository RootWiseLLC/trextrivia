version: '3.8'

# Run this separately from main deployment to scrape and load questions
# Usage: docker-compose -f docker-compose.scraper.yml run scraper

services:
  scraper:
    build:
      context: ./be-jeopardy
      dockerfile: Dockerfile.scraper
    environment:
      DATABASE_URL: postgresql://postgres:${POSTGRES_PASSWORD:-postgres}@postgres:5432/postgres?sslmode=disable
    volumes:
      # Mount clues directory so scraped data persists
      - ./be-jeopardy/clues:/app/clues
      # Mount scrapers so you can edit them without rebuilding
      - ./be-jeopardy/scrapers:/app/scrapers
      - ./be-jeopardy/insert_clues.py:/app/insert_clues.py
      - ./be-jeopardy/add_alternatives.py:/app/add_alternatives.py
    network_mode: host  # Access localhost postgres
    profiles:
      - tools  # Don't start automatically
